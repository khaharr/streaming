<template>
  <div class="container">
    <div class="d-flex justify-content-center">
      <h1>Documentation API</h1>
    </div>
    <div>
      <button v-for="(category, index) in categories" :key="index" @click="setActiveCategory(index)" class="category-button">
        {{ category.name }}
      </button>
    </div>
    <section v-for="(api, index) in activeCategory.apis" :key="index">
      <h4 class="text-center text-primary">{{ api.titre }}</h4>
      <h2>{{ api.method }} {{ api.url }}</h2>
      <p><strong>Description:</strong> {{ api.description }}</p>
      <p><strong>Résultat:</strong></p>
      <pre>{{ api.result }}</pre>
    </section>
  </div>
</template>

<script setup lang="ts">
const apis = [
  {
    category: "Fichiers",
    endpoints: [
      {
        titre: "Récupération de fichiers",
        method: 'GET',
        url: '/api/file/[env]/upload/list',
        description: "Récupère les options d'environnement, de zone et de catégories de fichiers disponibles pour le dépôt.",
        result: `{
          "zone": ["za", "zu"],
          "env": ["tipi", "tipi-client"],
          "datacat": {
            "za": {
              "nominoe": {
                "extention": ".xml",
                "format": "nominoe.xml"
              },
              "ics": {
                "extention": ".txt",
                "format": "LISTE_ICS_FRANCE"
              }
            },
            "zu": {
              "helios": {
                "extention": ".xml",
                "format": "TIPI"
              }
            }
          }
        }`
      },
      // autres endpoints pour Fichiers
    ]
  },
  {
    category: "Jeux de données",
    endpoints: [
      {
        titre: "Jeux de données",
        method: 'GET',
        url: '/api/dataset/{env}/listeps',
        description: 'Récupère une liste EPS avec des options de filtrage',
        result: `PARAMETRES DE requete {
          • limit(optionnel) : nombre maximal de résultats a retourner.
          • eps(optionnel): filtrer les clients URL.
          • ifurl(optionnel): filtrer les clients URL.
        }

        EXEMPLE DE Requete:
        GET /api/dataset/tipi/listeeps?limit=50&eps=avec&ifurl=yes

        EXEMPLE DE Réponse:
        [
          {"id":1, "name":"EPS1"},
          {"id":2, "name":"EPS2"}
        ]`
      },
      // autres endpoints pour Jeux de données
    ]
  },
  // autres catégories
];

const categories = [
  { name: "Fichiers", apis: apis.find(api => api.category === "Fichiers").endpoints },
  { name: "Jeux de données", apis: apis.find(api => api.category === "Jeux de données").endpoints },
  // autres catégories
];

const activeCategoryIndex = ref(0);
const activeCategory = computed(() => categories[activeCategoryIndex.value]);

const setActiveCategory = (index: number) => {
  activeCategoryIndex.value = index;
};
</script>

<style scoped>
.container {
  max-width: 800px;
  margin: auto;
  padding: 20px;
}

pre {
  padding: 10px;
  border: 1px solid #817d7d;
  border-radius: 5px;
  background-color: #f8f8f8;
}

h4 {
  padding: 10px;
  border: 1px solid #4c57f0;
  border-radius: 50px;
  text-align: center;
}

.category-button {
  margin: 10px 5px;
  padding: 10px 15px;
  background-color: #4c57f0;
  color: #fff;
  border: none;
  border-radius: 5px;
  cursor: pointer;
}

.category-button:hover {
  background-color: #3b45c4;
}
</style>